document.getElementById("gachaButton").addEventListener("click", () => {
  console.log("Button clicked");

  if (!Module || !Module.ccall) {
    alert("まだ初期化中のようです。もう少し待ってから試してください。");
    return;
  }

  const numberField = document.getElementById("userInput");
  console.log("numberField:", numberField);
  const inputValue = numberField.value;
  console.log("取得した入力値:", inputValue);
  const val = parseInt(inputValue, 10);
  console.log("parseInt後の値:", val);

  if (isNaN(val)) {
    alert("数値を入力してください！");
    return;
  } else if (val < 1) {
    alert("1以上の値を入力してください！");
    return;
  }

  const ret = Module.ccall(
    "gacya",    // C++ 関数名
    "number",   // 返り値の型
    ["number"], // 引数の型
    [val]       // 実際の引数
  );
  console.log("gacya() の戻り値:", ret);

  const ans = (ret === 1) ? "当たり🎉" : "ハズレ💔";
  document.getElementById("result").textContent = `結果: ${ans}`;
});


